import { DataSource } from 'typeorm';

import { SeedObjectMetadataIds } from 'src/database/typeorm-seeds/metadata/object-metadata';
import { SeedWorkspaceId } from 'src/database/seeds/metadata';

const fieldMetadataTableName = 'fieldMetadata';

export enum SeedPersonFieldMetadataIds {
  FirstName = '20202020-9b56-4888-bfe3-f6f59aa999e3',
  LastName = '20202020-b784-458a-869d-6c53fa85483d',

  Email = '20202020-8a96-4e4b-86fd-ea126530e0c1',
  LinkedinUrl = '20202020-dcf6-445a-b543-37e55de43c25',
  XUrl = '20202020-a3a7-4f63-9303-10226f6055be',
  JobTitle = '20202020-3b86-413e-ab56-0ebd1a583ff3',
  Phone = '20202020-486f-45f9-bbdf-aac18b1831c0',
  City = '20202020-78f8-4b4c-90ff-86adf77590f5',
  AvatarUrl = '20202020-bb05-45cb-aa2a-71b58d49dd23',

  Company = '20202020-64e1-4080-b6ad-db03c3809885',
  ContactForOpportunities = '20202020-2c2e-418e-ba2d-d28434ff02a6',
  Opportunities = '20202020-6bc4-4905-a9d3-4f8d616a19e1',
  ActivityTargets = '20202020-f285-4115-a46c-116522986b29',
  Favorites = '20202020-6268-4165-8774-9aaf45db2b25',
  Attachments = '20202020-5883-4bb3-a308-65271901a1d4',
}

export const seedPersonFieldMetadata = async (
  workspaceDataSource: DataSource,
  schemaName: string,
) => {
  await workspaceDataSource
    .createQueryBuilder()
    .insert()
    .into(`${schemaName}.${fieldMetadataTableName}`, [
      'id',
      'objectMetadataId',
      'isCustom',
      'workspaceId',
      'isActive',
      'type',
      'name',
      'label',
      'targetColumnMap',
      'description',
      'icon',
      'isNullable',
    ])
    .orIgnore()
    .values([
      // Main Identifier
      {
        id: SeedPersonFieldMetadataIds.FirstName,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'firstName',
        label: 'First name',
        targetColumnMap: {
          value: 'firstName',
        },
        description: 'Contact’s first name',
        icon: 'IconUser',
        isNullable: false,
      },
      {
        id: SeedPersonFieldMetadataIds.LastName,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'lastName',
        label: 'Last name',
        targetColumnMap: {
          value: 'lastName',
        },
        description: 'Contact’s last name',
        icon: 'IconUser',
        isNullable: false,
      },

      // Scalar Fields
      {
        id: SeedPersonFieldMetadataIds.Email,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'EMAIL',
        name: 'email',
        label: 'Email',
        targetColumnMap: {
          value: 'email',
        },
        description: 'Contact’s Email',
        icon: 'IconMail',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.LinkedinUrl,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'URL',
        name: 'linkedinUrl',
        label: 'Linkedin',
        targetColumnMap: {
          value: 'linkedinUrl',
        },
        description: 'Contact’s Linkedin account',
        icon: 'IconBrandLinkedin',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.XUrl,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'URL',
        name: 'xUrl',
        label: 'X',
        targetColumnMap: {
          value: 'xUrl',
        },
        description: 'Contact’s X/Twitter account',
        icon: 'IconUser',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.JobTitle,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'jobTitle',
        label: 'Job Title',
        targetColumnMap: {
          value: 'jobTitle',
        },
        description: 'Contact’s job title',
        icon: 'IconBriefcase',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.Phone,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'phone',
        label: 'Phone',
        targetColumnMap: {
          value: 'phone',
        },
        description: 'Contact’s phone number',
        icon: 'IconPhone',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.City,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'city',
        label: 'City',
        targetColumnMap: {
          value: 'city',
        },
        description: 'Contact’s city',
        icon: 'IconMap',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.AvatarUrl,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'avatarUrl',
        label: 'Avatar',
        targetColumnMap: {
          value: 'avatarUrl',
        },
        description: 'Contact’s avatar',
        icon: 'IconFileUpload',
        isNullable: false,
      },

      // Relationships
      {
        id: SeedPersonFieldMetadataIds.Company,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'company',
        label: 'Company',
        targetColumnMap: {
          value: 'companyId',
        },
        description: 'Contact’s company',
        icon: 'IconBuildingSkyscraper',
        isNullable: false,
      },
      {
        id: SeedPersonFieldMetadataIds.ContactForOpportunities,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'pointOfContactForOpporunities',
        label: 'POC for Opportunities',
        targetColumnMap: {},
        description: 'Point of Contact for Opportuniites',
        icon: 'IconArrowTarget',
        isNullable: false,
      },
      {
        id: SeedPersonFieldMetadataIds.ActivityTargets,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'activityTargets',
        label: 'Activities',
        targetColumnMap: {},
        description: 'Activities tied to the contact',
        icon: 'IconCheckbox',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.Opportunities,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'opportunities',
        label: 'Opportunities',
        targetColumnMap: {},
        description: 'Opportunities linked to the contact.',
        icon: 'IconTargetArrow',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.Favorites,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'favorites',
        label: 'Favorites',
        targetColumnMap: {},
        description: 'Favorites linked to the contact',
        icon: 'IconHeart',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadataIds.Attachments,
        objectMetadataId: SeedObjectMetadataIds.Person,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'attachments',
        label: 'Attachments',
        targetColumnMap: {},
        description: 'Attachments linked to the contact.',
        icon: 'IconFileImport',
        isNullable: true,
      },
    ])
    .execute();
};
